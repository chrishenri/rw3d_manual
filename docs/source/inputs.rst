.. _inputs:

Input Instructions
===============

2 files have to be provided: 

- Name file: File with names for input and output files (by default: **rw3d.nam**)
- Parameter file: File with parameters (file name to be defined in the name file)


Type of inputs
------------

- ``logical``: ``T`` for True; ``F`` for False
- ``string``
- ``integer``
- ``real``
- ``array``: The parameter is potentially spatially variable and can be read from a file. The following information have to be provided in a single line: ``file name`` ``multiplier`` ``ivar`` ``flag``. 
  In some specific cases, one or two additional parameters (*options*) must also be provided. 

.. container::
   :name: table-array

   .. table:: Array.

      +-----------------------------+--------------------+-----------------------------------------------------------------------------------------------------------+
      | Variable                    | Type               | Description                                                                                               |
      +======+======================+====================+===========================================================================================================+
      | ``file name``               | ``string``         | name of the file. Put some text even if no file is used                                                   |
      +-----------------------------+--------------------+-----------------------------------------------------------------------------------------------------------+
      | ``multiplier``              | ``real``           | multiplier of the variable                                                                                |
      +-----------------------------+--------------------+-----------------------------------------------------------------------------------------------------------+
      | ``ivar``                    | ``integer``        | variable index of the variable in the gslib array                                                         |
      +-----------------------------+--------------------+-----------------------------------------------------------------------------------------------------------+
      | ``flag``                    | ``integer``        | way to read the values of the parameter                                                                   |
      |                             |                    |                                                                                                           |
      |                             |                    | values:                                                                                                   |
      |                             |                    |                                                                                                           |
      |                             |                    | - 0: the parameter is not read from a file and is defined as the multiplier                               |
      |                             |                    | - 1: the parameter is read from the ascii file specified in ``file name``                                 |
      |                             |                    | - 2: the parameter is read from a MODFLOW type file (only available for fluxes)                           |
      |                             |                    | - 3: the parameter is read from the ascii file specified in ``file name``but from the bottom of the file  |
      |                             |                    | - 4: the parameter is read from a netcdf file. For the moment, only NETCDF3_64BIT file type is supported  |
      |                             |                    |                                                                                                           |
      +-----------------------------+--------------------+-----------------------------------------------------------------------------------------------------------+


File format
`````````````

- **ascii file (``flag``=1 or 3)**

A text file (with name ``file name``) must follow the following format: 

.. container::
   :name: table-array

   .. table:: Ascii file format.
 
      +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
      |Line  | Variable                                                                | Type               | Description                                                                            |
      +======+=========================================================================+====================+========================================================================================+
      | 1    | ``header``                                                              | ``string``         | header line (*not used by the code*)                                                   |
      +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
      | 2    | ``nvar``                                                                | ``integer``        | number of variables                                                                    |
      +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
      | repeat the following line ``nvar`` times:                                                                                                                                                    |
      +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
      | 3    | ``nvar_name``                                                           | ``string``         | name of the variable (*not used by the code*)                                          |
      +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
      | repeat the following line :math:`nx \times ny \times nz` times:                                                                                                                              |
      +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
      | 4    | ``values``                                                              | ``real``           | variable values                                                                        |
      +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+

A single file can contain information about multiple (``nvar``) variables. 
The values of each variable is defined in space separated columns. The file must contain :math:`nx \times ny \times nz` rows, where :math:`ni` is the number of cells in the *i*-th dimension. 
All values are corrected by multiplying the read values by ``multiplier``. 

The values of the variable with index ``ivar`` are read as follow: 

.. code-block:: fortran

    do k=1,nz
        do j=1,ny
            do i=1,nx
                read(iunit,*) (aline(jcol),jcol=1,nvar)    ! read all columns, i.e., all variables values, corresponding to the location (i,j,k)
                values(i,j,k) = aline(ivar) * multiplier   ! values of the selected variable (corresponding to the column ivar), corrected by a user-defined constant (multiplier) 
            end do
        end do
    end do


- **netcdf file (``flag``=4)**



Name file
------------

The file consists in 15 lines that must be defined as follow (even if the output option is disabled in the parameter file): 

.. _tbl-grid:
 
  +------+--------------+------------------------------------------------------------+
  |Line  | item type    | Description                                                |
  +======+==============+============================================================+
  | 1    | File name    | Parameter file                                             |
  +------+--------------+------------------------------------------------------------+
  | 2    | File name    | Output histogram (pdf) of particle arrival times (btcs)    |
  +------+--------------+------------------------------------------------------------+
  | 3    | File name    | Output with cumulative pdf particle arrival times (cbtcs)  |
  +------+--------------+------------------------------------------------------------+
  | 4    | File name    | Output with particle snapshots with time                   |
  +------+--------------+------------------------------------------------------------+
  | 5    | File name    | Output with particle paths                                 |
  +------+--------------+------------------------------------------------------------+
  | 6    | File name    | Output with cartesian spatial moments                      |
  +------+--------------+------------------------------------------------------------+
  | 7    | File name    | Output with temporal moments of breakthrough curves        |
  +------+--------------+------------------------------------------------------------+
  | 8    | File name    | Output with velocity field (for idebug :math:`\geq 1`)     |
  +------+--------------+------------------------------------------------------------+
  | 9    | File name    | Output with debug file                                     |
  +------+--------------+------------------------------------------------------------+
  | 10   | File name    | Output with information about particle exiting the domain  |
  +------+--------------+------------------------------------------------------------+
  | 11   | File name    | Output with btcs of particle entering registration lenses  |
  +------+--------------+------------------------------------------------------------+
  | 12   | File name    | Output with cbtcs of particle entering registration lenses |
  +------+--------------+------------------------------------------------------------+
  | 13   | File name    | Output with btcs of particle exiting registration lenses   |
  +------+--------------+------------------------------------------------------------+
  | 14   | File name    | Output with cbtcs of particle exiting registration lenses  |
  +------+--------------+------------------------------------------------------------+
  | 15   | File name    | Output with plume history                                  |
  +------+--------------+------------------------------------------------------------+


Parameter file
------------

The parameter file consists in a text file. The following blocks of information has to be sequentially provided. 

- :ref:`General setup`
- :ref:`Geometry`
- :ref:`Time discretization`
- :ref:`Advection`
- :ref:`Heads`
- :ref:`Sinks`
- :ref:`Diffusion / Dispersion`
- :ref:`Mass Transfer`
- :ref:`Reactions`
    - Retardation
    - First-order reactions
    - Bimolecular 
- Observations 
- Injection
- Recirculation
- Outputs

.. warning::
    Note that 3 header lines has to be written before each block. 


.. _General setup:

General setup
`````````````

.. _tbl-grid:
  
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  |Line  | Variable                                                                | Type               | Description                                                                            |
  +======+=========================================================================+====================+========================================================================================+
  | 10   | ``idebug``                                                              | ``integer``        | ``idebug``: Integer defining degree of debugging as written in rw3d_general.dbg        |
  |      |                                                                         |                    |                                                                                        |
  |      |                                                                         |                    | *values*:                                                                              |
  |      |                                                                         |                    |                                                                                        |
  |      |                                                                         |                    |         - -1: Do not write the velocity field                                          |
  |      |                                                                         |                    |         - 0: Normal Run                                                                |
  |      |                                                                         |                    |         - 10: Maximum Debugging Degree                                                 |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 11   | ``nspe_aq`` ``nspe_min``                                                | ``integer``        | ``nspe_aq``: number of aqueous (i.e., mobile) species                                  |
  |      |                                                                         |                    |                                                                                        |
  |      |                                                                         |                    | ``nspe_min``: number of aqueous (i.e., immobile) species                               |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 12   | ``name_aq``                                                             | ``string``         | ``name_aq``: name(s) of aqueous (i.e., mobile) species                                 |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 13   | ``name_min``                                                            | ``string``         | ``name_min``: name(s) of aqueous (i.e., immobile) species                              |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 14   | ``t_sim``                                                               | ``real``           | ``t_sim``: simulation time                                                             |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 15   | ``transient_flag``                                                      | ``logical``        | ``transient_flag``: True if transient conditions                                       |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | if ``transient_flag`` == ``F``, go to :ref:`Geometry`; if ``transient_flag`` == ``T``, fill up the following:                                                                                |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 16   | ``read_dt_from_file``  ``loop_dt``                                      | ``logical``        | ``read_dt_from_file``: True if the time steps are read from an ascii file              |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | if ``read_dt_from_file`` == ``T``:                                                                                                                                                           |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 17   | ``dt_file``                                                             | ``string``         | ``dt_file``: name of the ascii file listing the time steps                             |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | if ``read_dt_from_file`` == ``T``, go to :ref:`Geometry`; if ``read_dt_from_file`` == ``F``:                                                                                                 |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 18   | ``n_dt``                                                                | ``integer``        | ``n_dt``: number of time steps                                                         |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | to be repeated :math:`n_{dt}` times:                                                                                                                                                         |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 19...| ``dt``                                                                  | ``real``           | ``dt``: time step                                                                      |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+


Example:

::

   -----------------------------------------------------------------
    General Setup
   -----------------------------------------------------------------
   0                                   !idebug
   2   0                               !nspe_aq; nspe_min
   A   B                               !name_aq
   -                                   !name_min
   150.0                               !t_sim
   T                                   !transient_flag
   T   T                               !read_dt_from_file; loop_dt
   time_discretization.dat             !dt_file


.. _Geometry:

Geometry
`````````````

.. raw:: latex

    \begin{landscape}

.. _tbl-grid:
  
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  |Line  | Variable                                                                | Type               | Description                                                                            |
  +======+=========================================================================+====================+========================================================================================+
  | 22   | ``nx`` ``ny`` ``nz``                                                    | ``integer``        | ``nx``: number of cell in the *x* direction (i.e., columns)                            |
  |      |                                                                         |                    |                                                                                        |
  |      |                                                                         |                    | ``ny``: number of cell in the *y* direction (i.e., rows)                               |
  |      |                                                                         |                    |                                                                                        |
  |      |                                                                         |                    | ``nz``: number of cell in the *z* direction (i.e., layers)                             |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 23   | ``dx``                                                                  | ``array``          | ``dx``: cell size in the *x* direction                                                 |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 24   | ``dy``                                                                  | ``array``          | ``dy``: cell size in the *y* direction                                                 |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 25   | ``dz``                                                                  | ``array, 1 option``| ``dz``: cell size in the *z* direction                                                 |
  |      |                                                                         |                    |                                                                                        |
  |      |                                                                         |                    | *option*: Constant layer thickness                                                     |
  |      |                                                                         |                    |                                                                                        |
  |      |                                                                         |                    |    - ``logical``: ``T`` if constant layer thickness, ``F`` if variable layer thickess  |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 26   | ``floor``                                                               | ``array``          | ``floor``: floor elevation                                                             |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 27   | ``inactive_cell``                                                       | ``array, 1 option``| ``inactive_cell``: binary characteriztion of active/inactive cells                     |
  |      |                                                                         |                    |                                                                                        |
  |      |                                                                         |                    | *values*: 0: active; 1: inactive                                                       |
  |      |                                                                         |                    |                                                                                        |
  |      |                                                                         |                    | *option*: Particle in inactive cells are killed                                        |
  |      |                                                                         |                    |                                                                                        |
  |      |                                                                         |                    |    - ``logical``: ``T`` particles are killed, ``F`` particles bounce at the boundary   |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 28   | ``ib(1,1)`` ``ib(1,2)`` ``ib(2,1)`` ``ib(2,2)`` ``ib(3,1)`` ``ib(3,2)`` | ``integer``        | Defines the particle behaviour if a domain boundary is reached.                        |
  |      |                                                                         |                    |                                                                                        |
  |      |                                                                         |                    | ``ib(1,1)``: left boundary, defined by x_min                                           |
  |      |                                                                         |                    |                                                                                        |
  |      |                                                                         |                    | ``ib(1,2)``: right boundary, defined by x_max                                          |
  |      |                                                                         |                    |                                                                                        |
  |      |                                                                         |                    | ``ib(2,1)``: front boundary, defined by y_min                                          |
  |      |                                                                         |                    |                                                                                        |
  |      |                                                                         |                    | ``ib(2,2)``: back boundary, defined by y_max                                           |
  |      |                                                                         |                    |                                                                                        |
  |      |                                                                         |                    | ``ib(2,1)``: bottom boundary, defined by z_min                                         |
  |      |                                                                         |                    |                                                                                        |
  |      |                                                                         |                    | ``ib(2,2)``: top boundary, defined by z_max                                            |
  |      |                                                                         |                    |                                                                                        |
  |      |                                                                         |                    | *values*:                                                                              |
  |      |                                                                         |                    |                                                                                        |
  |      |                                                                         |                    |    - 0: The particle is killed                                                         |
  |      |                                                                         |                    |    - 1: The particle is sent to the opposite side of the domain                        |
  |      |                                                                         |                    |    - 2: The particle bounces at the boundary                                           |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+

.. raw:: latex

    \end{landscape}

Example:

::

   ---------------------------------------------------------------
    Geometry
   ---------------------------------------------------------------
   1200    1400    11                               !nx; ny; nz
   not_used             100.0    1    0             !dx
   not_used             100.0    1    0             !dy
   dz.dat               1.0      1    1    F        !dz
   floor.dat            1.0      1    1             !floor
   InactCell.dat        1.0      1    1    T        !inactive_cell
   0   0   0   0   0   1                            !ib(1,1); ib(1,2); ib(2,1); ib(2,2); ib(3,1); ib(3,2)


.. _Time discretization:

Time discretization
`````````````

.. _tbl-grid:
  
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  |Line  | Variable                                                                | Type               | Description                                                                            |
  +======+=========================================================================+====================+========================================================================================+
  | 32   | ``dt_method``                                                           | ``string``         | Defines the way time steps are computed                                                |
  |      |                                                                         |                    |                                                                                        |
  |      |                                                                         |                    | *values*: description provided in section :ref:`Time discretization process`           |
  |      |                                                                         |                    |                                                                                        |
  |      |                                                                         |                    |    - ``constant_dt``                                                                   |
  |      |                                                                         |                    |    - ``constant_cu``                                                                   |
  |      |                                                                         |                    |    - ``constant_damt``                                                                 |
  |      |                                                                         |                    |    - ``constant_dadecay``                                                              |
  |      |                                                                         |                    |    - ``optimum_dt``                                                                    |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 33   | ``dt`` ``courant`` ``peclet`` ``DaKINETIC`` ``DaDECAY`` ``DaMMT``       | ``real``           | Time step restrictor, as defined in section :ref:`Time discretization process`         |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+



.. _Advection:

Advection
`````````````

.. _tbl-grid:
  
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  |Line  | Variable                                                                | Type               | Description                                                                            |
  +======+=========================================================================+====================+========================================================================================+
  | 36   | ``advection_action``                                                    | ``logical``        | True if the package is activated                                                       |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 37   | ``advection_method``                                                    | ``logical``        | Method of velocity interpolation, as defined in :ref:`Velocities Interpolation`        |
  |      |                                                                         |                    |                                                                                        |
  |      |                                                                         |                    | *values*:                                                                              |
  |      |                                                                         |                    |                                                                                        |
  |      |                                                                         |                    |    - ``exponential``                                                                   |
  |      |                                                                         |                    |    - ``eulerian``                                                                      |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 38   | ``q_x``                                                                 | ``array``          | flux in the *x* direction                                                              |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 39   | ``q_y``                                                                 | ``array``          | flux in the *y* direction                                                              |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 40   | ``q_z``                                                                 | ``array``          | flux in the *z* direction                                                              |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 41   | ``porosity``                                                            | ``array, 1 option``| porosity (or water content)                                                            |
  |      |                                                                         |                    |                                                                                        |
  |      |                                                                         |                    | *option*: transient conditions                                                         |
  |      |                                                                         |                    |                                                                                        |
  |      |                                                                         |                    |    - ``logical``: ``T`` transient field, ``F`` steady-state field                      |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+


.. _Heads:

Heads
`````````````

.. _tbl-grid:
  
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  |Line  | Variable                                                                | Type               | Description                                                                            |
  +======+=========================================================================+====================+========================================================================================+
  | 45   | ``heads_action``                                                        | ``logical``        | True if the package is activated                                                       |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 46   | ``heads``                                                               | ``array``          | cell-by-cell head elevation                                                            |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 47   | ``heads_threshold``                                                     | ``real``           | maximum head elevation for the cell to be considered dry                               |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+


.. _Sinks:

Sinks
`````````````

.. _tbl-grid:
  
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  |Line  | Variable                                                                | Type               | Description                                                                            |
  +======+=========================================================================+====================+========================================================================================+
  | 51   | ``sinks_action``                                                        | ``logical``        | True if the package is activated                                                       |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 52   | ``n_sinks``                                                             | ``integer``        | number of sink                                                                         |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | to be repeated :math:`n_{sinks}` times:                                                                                                                                                      |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 53...| ``sink_name`` ``Q_sink``                                                |``string`` ``array``| ``sink_name``: name of the sink                                                        |
  |      |                                                                         |                    |                                                                                        |
  |      |                                                                         |                    | ``Q_sink``: flow going into the sink (:math:`L^3/T`)                                   |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+


.. _Diffusion / Dispersion:

Dispersion / Disffusion
`````````````

.. _tbl-grid:
  
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  |Line  | Variable                                                                | Type               | Description                                                                            |
  +======+=========================================================================+====================+========================================================================================+
  | 57   | ``dispersion_action``                                                   | ``logical``        | True if the package is activated                                                       |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 58   | ``dispersivity_L``                                                      | ``array``          | dispersivity in the longitudinal direction                                             |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 59   | ``dispersivity_TH``                                                     | ``array``          | dispersivity in the transverse horizontal direction                                    |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 60   | ``dispersivity_TV``                                                     | ``array``          | dispersivity in the transverse vertical direction                                      |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 61   | ``diffusion_L``                                                         | ``array, 1 option``| effective molecular diffusion in the longitudinal direaction                           |
  |      |                                                                         |                    |                                                                                        |
  |      |                                                                         |                    | *option*: transient conditions                                                         |
  |      |                                                                         |                    |                                                                                        |
  |      |                                                                         |                    |    - ``logical``: ``T`` transient field, ``F`` steady-state field                      |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 62   | ``diffusion_TH``                                                        | ``array, 1 option``| effective molecular diffusion in the transverse horizontal direaction                  |
  |      |                                                                         |                    |                                                                                        |
  |      |                                                                         |                    | *option*: transient conditions                                                         |
  |      |                                                                         |                    |                                                                                        |
  |      |                                                                         |                    |    - ``logical``: ``T`` transient field, ``F`` steady-state field                      |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 63   | ``diffusion_TV``                                                        | ``array, 1 option``| effective molecular diffusion in the transverse vertical direaction                    |
  |      |                                                                         |                    |                                                                                        |
  |      |                                                                         |                    | *option*: transient conditions                                                         |
  |      |                                                                         |                    |                                                                                        |
  |      |                                                                         |                    |    - ``logical``: ``T`` transient field, ``F`` steady-state field                      |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 64   | ``diffusion_factor`` (repeat ``nspe_aq`` times)                         | ``real``           | Species dependent multiplier for the diffusion coefficients                            |
  |      |                                                                         |                    |                                                                                        |
  |      |                                                                         |                    | *for each aqueous species, the effective diffusion coefficient*                        |
  |      |                                                                         |                    | *is multiplied by the given factor*                                                    |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+


.. _Mass transfer:

Mass transfer
`````````````

.. _tbl-grid:

  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  |Line  | Variable                                                                | Type               | Description                                                                            |
  +======+=========================================================================+====================+========================================================================================+
  | 68   | ``mass_transfer_action``                                                | ``logical``        | True if the package is activated                                                       |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 69   | ``type_mass_transfer``                                                  | ``string``         | Defines the type of mass transfer process                                              |
  |      |                                                                         |                    |                                                                                        |
  |      |                                                                         |                    | *values*: description provided in section :ref:`Multirate Mass Transfer process`       |
  |      |                                                                         |                    |                                                                                        |
  |      |                                                                         |                    |    - ``multirate``                                                                     |
  |      |                                                                         |                    |    - ``spherical_diffusion``                                                           |
  |      |                                                                         |                    |    - ``layered_diffusion``                                                             |
  |      |                                                                         |                    |    - ``cylindral_diffusion``                                                           |
  |      |                                                                         |                    |    - ``power_law``                                                                     |
  |      |                                                                         |                    |    - ``lognormal_law``                                                                 |
  |      |                                                                         |                    |    - ``composite_law``                                                                 |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | if ``type_mass_transfer`` = ``multirate`` or ``spherical_diffusion`` or ``layered_diffusion`` or ``cylindral_diffusion``:                                                                    |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 70   | ``num_immobile_zones``                                                  | ``integer``        | number of immobile zones                                                               |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | to be repeated ``num_immobile_zones`` times:                                                                                                                                                 |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 71   | ``porosity_immobile``                                                   | ``array``          | porosity in the ith immobile zone                                                      |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 72   | ``mass_transfer_coef``                                                  | ``array``          | mass transfer coefficient in the ith immobile zone                                     |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | if ``type_mass_transfer`` = ``power_law``:                                                                                                                                                   |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 70   | ``num_immobile_zones``                                                  | ``integer``        | number of immobile zones                                                               |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | to be repeated ``num_immobile_zones`` times:                                                                                                                                                 |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 71   | ``btot``                                                                | ``array``          | total capacity                                                                         |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 72   | ``Amin``                                                                | ``array``          | minimum mass transfer coefficient                                                      |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 73   | ``Amax``                                                                | ``array``          | maximum mass transfer coefficient                                                      |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 74   | ``power``                                                               | ``array``          | power coefficient                                                                      |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | if ``type_mass_transfer`` = ``lognormal_law``:                                                                                                                                               |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 70   | ``num_immobile_zones``                                                  | ``integer``        | number of immobile zones                                                               |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | to be repeated ``num_immobile_zones`` times:                                                                                                                                                 |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 71   | ``btot``                                                                | ``array``          | total capacity                                                                         |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 72   | ``mean``                                                                | ``array``          | mean of the lognormal mass transfer coefficients                                       |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 73   | ``stdv``                                                                | ``array``          | standart deviation in mass transfer coefficients                                       |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | if ``type_mass_transfer`` = ``composite_law``:                                                                                                                                               |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | 71   | ``nmrate`` ``nsph`` ``ncyl`` ``nlay``                                   | ``integer``        | ``nmrate``: number of immobile zones for the multirate mass transfer model             |
  |      |                                                                         |                    |                                                                                        |
  |      |                                                                         |                    | ``nsph``: number of immobile zones for the spherical diffusion model                   |
  |      |                                                                         |                    |                                                                                        |
  |      |                                                                         |                    | ``ncyl``: number of immobile zones for the cylindral diffusion model                   |
  |      |                                                                         |                    |                                                                                        |
  |      |                                                                         |                    | ``nlay``: number of immobile zones for the layered diffusion model                     |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  | for each mass transfer model, fill up sequentially the corresponding parameters as described above                                                                                           |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+


.. _Reactions:

Reactions
`````````````

.. _tbl-grid:

  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
  |Line  | Variable                                                                | Type               | Description                                                                            |
  +======+=========================================================================+====================+========================================================================================+
  | 68   | ``reaction_action``                                                     | ``logical``        | True if the package is activated                                                       |
  +------+-------------------------------------------------------------------------+--------------------+----------------------------------------------------------------------------------------+
